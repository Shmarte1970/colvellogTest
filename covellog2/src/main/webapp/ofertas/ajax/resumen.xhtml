<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:p="http://primefaces.org/ui"
      xmlns:d="http://xmlns.jcp.org/jsf/composite/es/zarca/covellog/direccion"
      xmlns:ub="http://xmlns.jcp.org/jsf/composite/es/zarca/covellog/ubicacion"
      xmlns:em="http://xmlns.jcp.org/jsf/composite/es/zarca/covellog/empresa"
      xmlns:e="http://xmlns.jcp.org/jsf/composite/es/zarca/covellog/empresa"
      xmlns:jsf="http://xmlns.jcp.org/jsf"
      xmlns:c="http://xmlns.jcp.org/jsf/composite/es/zarca/covellog/contacto"
      xmlns:f="http://xmlns.jcp.org/jsf/core">
    <ui:composition>        
        <div>
            <h:form id="ContratoResumenForm">
                <h:panelGroup id="display" class="print-content">
                    <div class="print-col" style="width:100%;padding:10px">
                    <div class="print-row">
                        <div class="print-col" style="width:50%;padding-right:5px">
                            <div class="print-row" style="background-color: #DDD;padding:10px;width:100%">
                                <div class="print-col info-cabecera-icono">
                                    <i class="fa fa-file" style="color: #666;font-size: 48px"></i>
                                </div>                                
                                <div class="print-col info-cabecera-texto" style="width:85%">
                                    <ul class="datos">
                                        <li>
                                            <h:outputLabel value="Id Contrato: " /> 
                                            <h:outputText 
                                                value="#{contratoResumenBean.contrato.friendlyId}" 
                                            />
                                        </li>
                                        <li>
                                            <h:outputLabel value="Fecha: " /> 
                                            <h:outputText 
                                                value="#{contratoResumenBean.contrato.fechaContrato}" 
                                            >
                                                <f:convertDateTime pattern="dd-MM-yyyy" timeZone="CET"/> 
                                            </h:outputText>
                                        </li>
                                        
                                        
                                    </ul>
                                </div>
                            </div>
                            <div class="print-row" style="margin-top:10px;background-color: #DDD;padding:10px;width:100%">
                                <div class="print-col info-cabecera-icono">
                                    <i class="fa fa-user" style="color: #666;font-size: 48px"></i>
                                </div>
                                <div jsf:rendered="#{contratoResumenBean.contrato.cliente != null}" class="print-col info-cabecera-texto" style="width:85%">
                                    <ul class="datos">
                                        <li>
                                            <h:outputLabel value="Cliente: " /> 
                                            <h:outputText 
                                                value="#{contratoResumenBean.contrato.cliente.friendlyId}" 
                                            />
                                        </li>
                                        <li>
                                            <h:outputLabel value="CIF: " /> 
                                            <h:outputText 
                                                value="#{contratoResumenBean.contrato.cliente.cif}" 
                                            />
                                        </li>
                                        <li>
                                            <h:outputLabel value="R.Social: " /> 
                                            <h:outputText 
                                                value="#{contratoResumenBean.contrato.cliente.nombre}" 
                                            />
                                        </li>
                                        <li>
                                            <div class="print-row">
                                                <div class="print-col">
                                                    <h:outputLabel value="Contacto: " /> 
                                                </div>
                                                <div class="print-col" style="padding-left:0.5em">
                                                    <c:contactoPrint value="#{contratoResumenBean.contrato.firmante}" />
                                                </div>
                                            </div>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                            <div class="print-row" style="margin-top:10px;background-color: #DDD;padding:10px;width:100%">
                                <div class="print-col info-cabecera-icono">
                                    <i class="fa fa-credit-card" style="color: #666;font-size: 48px"></i>
                                </div>
                                <div class="print-col info-cabecera-texto" style="padding-left:1em;width:85%">
                                    <div style="white-space: nowrap">
                                        Forma de pago venta
                                    </div>
                                    <div 
                                        jsf:rendered="#{not empty contratoResumenBean.contrato.facturacion.formaPagoVenta}"
                                        style="padding-left:0.6em"
                                    >
                                        <e:formaPagoPrint 
                                            value="#{contratoResumenBean.contrato.facturacion.formaPagoVenta}" 
                                        />
                                    </div>
                                    <div 
                                        style="padding-left:0.6em"
                                        jsf:rendered="#{empty contratoResumenBean.contrato.facturacion.formaPagoVenta}"
                                    >
                                        Sin forma de pago
                                    </div>
                                    <div 
                                        style="white-space: nowrap"
                                    >
                                        Forma de pago alquiler
                                    </div>
                                    <div 
                                        style="padding-left:0.6em"
                                        jsf:rendered="#{not empty contratoResumenBean.contrato.facturacion.formaPagoAlquiler}"
                                    >
                                        <e:formaPagoPrint 
                                            value="#{contratoResumenBean.contrato.facturacion.formaPagoAlquiler}" 
                                        />
                                    </div>
                                    <div 
                                        style="padding-left:0.6em"
                                        jsf:rendered="#{empty contratoResumenBean.contrato.facturacion.formaPagoAlquiler}"
                                    >
                                        Sin forma de pago
                                    </div>
                                </div>
                            </div>
                            <div class="print-row" style="margin-top:10px;background-color: #DDD;padding:10px;;width:100%">
                                <div class="print-col info-cabecera-icono">
                                    <i class="fa fa-truck" style="color: #666;font-size: 48px"></i>
                                </div>
                                <div class="print-col info-cabecera-texto" style="width:85%">
                                    <ul class="datos">
                                        <li>
                                            <h:outputLabel value="Dirección Entrega " /> 
                                            <div jsf:rendered="#{contratoResumenBean.contrato.direccionEnvio != null}">
                                                <div style="padding-left: 1em" jsf:rendered="#{not empty contratoResumenBean.contrato.direccionEnvio.contactos}">
                                                    <h:outputText value="Contacto: " />
                                                    <h:outputText value="#{contratoResumenBean.contrato.direccionEnvio.contactos.get(0).nombre}" />
                                                    <h:outputText style="margin-left:1em" value="Telf: " />
                                                    <h:outputText value="#{contratoResumenBean.contrato.direccionEnvio.contactos.get(0).telefono}" />
                                                </div>
                                                <div jsf:rendered="#{empty contratoResumenBean.contrato.direccionEnvio.contactos}">
                                                    <h:outputText value="Sin Contacto" />
                                                </div>
                                                <d:direccionPrint value="#{contratoResumenBean.contrato.direccionEnvio.direccion}" />
                                            </div>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                        <div class="print-col" style="width:50%;padding-left:5px;float:right">                            
                            <div class="print-row" style="background-color: #DDD;padding:10px;width:100%;">
                                <div class="print-col info-cabecera-icono" style="padding:0 8px 0 0">
                                    <i class="fa fa-euro-sign" style="color: #666;font-size: 48px"></i>
                                </div>
                                <div class="print-col info-cabecera-texto" style="padding-top: 2px;width:14em;text-align: right;margin:4px">
                                    <div style="text-align:center;background-color: #AAA;padding: 0.25em 0">ALQUILER</div>
                                    <ul class="datos">
                                        <li style="padding:4px">
                                            <div><h:outputLabel style="padding:0" value="Total" /></div>
                                            <div>
                                                <h:outputText 
                                                    style="font-size:1.5em"
                                                    value="#{contratoResumenBean.contrato.resumen.resumenAlquiler.total}€/#{contratoResumenBean.contrato.condiciones.facturarPor.nombre}" 
                                                />
                                            </div>
                                        </li>
                                        <li style="padding:4px">
                                            <div><h:outputLabel style="padding:0" value="Total Base" /></div>
                                            <div>
                                                <h:outputText 
                                                    style="font-size:1.5em"
                                                    value="#{contratoResumenBean.contrato.resumen.resumenAlquiler.totalBase}€/#{contratoResumenBean.contrato.condiciones.facturarPor.nombre}" 
                                                />
                                            </div>
                                        </li>
                                        <li style="padding:4px">
                                            <div><h:outputLabel style="padding:0" value="Complementos" /></div>
                                            <div style="padding-left:1em">
                                                <h:outputText 
                                                    style="font-size:1.5em"
                                                    value="#{contratoResumenBean.contrato.resumen.resumenAlquiler.totalComplementos}€/#{contratoResumenBean.contrato.condiciones.facturarPor.nombre}" 
                                                />
                                            </div>
                                        </li>                                        
                                        <li style="padding:4px">
                                            <div><h:outputLabel style="padding:0" value="Gastos Adicionales" /></div>
                                            <div style="padding-left:1em">
                                                <h:outputText 
                                                    style="font-size:1.5em"
                                                    value="#{contratoResumenBean.contrato.resumen.resumenAlquiler.totalGastosAdicionales}€" 
                                                />
                                            </div>
                                        </li>
                                        <li style="padding:4px">
                                            <div><h:outputLabel style="padding:0" value="Transportes" /></div>
                                            <div style="padding-left:1em">
                                                <h:outputText 
                                                    style="font-size:1.5em"
                                                    value="#{contratoResumenBean.contrato.resumen.resumenAlquiler.totalTransporte}€" 
                                                />
                                            </div>
                                        </li>
                                    </ul>
                                </div>
                                <div class="print-col info-cabecera-texto" style="padding-top: 2px;width:14em;text-align: right;margin:4px">
                                    <div style="text-align:center;background-color: #AAA;padding: 0.25em 0">VENTA</div>
                                    <ul class="datos">
                                        <li style="padding:4px">
                                            <div><h:outputLabel style="padding:0" value="Total" /></div>
                                            <div style="padding-left:1em;">
                                                <h:outputText 
                                                    style="font-size:1.5em;"
                                                    value="#{contratoResumenBean.contrato.resumen.resumenVenta.total}€" 
                                                />
                                            </div>
                                        </li>
                                        <li style="padding:4px">
                                            <div><h:outputLabel style="padding:0" value="Total Base" /></div>
                                            <div style="padding-left:1em;">
                                                <h:outputText 
                                                    style="font-size:1.5em;"
                                                    value="#{contratoResumenBean.contrato.resumen.resumenVenta.totalBase}€" 
                                                />
                                            </div>
                                        </li>
                                        <li style="padding:4px">
                                            <div><h:outputLabel style="padding:0" value="Complementos" /></div>
                                            <div style="padding-left:1em">
                                                <h:outputText 
                                                    style="font-size:1.5em"
                                                    value="#{contratoResumenBean.contrato.resumen.resumenVenta.totalComplementos}€" 
                                                />
                                            </div>
                                        </li>
                                        <li style="padding:4px">
                                            <div><h:outputLabel style="padding:0" value="Gastos Adicionales" /></div>
                                            <div style="padding-left:1em">
                                                <h:outputText 
                                                    style="font-size:1.5em"
                                                    value="#{contratoResumenBean.contrato.resumen.resumenVenta.totalGastosAdicionales}€" 
                                                />
                                            </div>
                                        </li>
                                        <li style="padding:4px">
                                            <div><h:outputLabel style="padding:0" value="Transportes" /></div>
                                            <div style="padding-left:1em">
                                                <h:outputText 
                                                    style="font-size:1.5em"
                                                    value="#{contratoResumenBean.contrato.resumen.resumenVenta.totalTransporte}€" 
                                                />
                                            </div>
                                        </li>
                                    </ul>
                                </div>
                                <div class="print-col info-cabecera-texto" style="padding-top: 2px;width:14em;text-align: right;margin:4px">
                                    <div style="text-align:center;background-color: #AAA;padding: 0.25em 0">TOTAL (#{contratoResumenBean.contrato.resumen.estimacionMesesAlquiler} meses)</div>
                                    <ul class="datos">
                                        <li style="padding:4px">
                                            <div><h:outputLabel style="padding:0" value="Total" /></div>
                                            <div>
                                                <h:outputText 
                                                    style="font-size:1.5em"
                                                    value="#{contratoResumenBean.contrato.resumen.resumenTotal.total}€" 
                                                />
                                            </div>
                                        </li>
                                        <li style="padding:4px">
                                            <div><h:outputLabel style="padding:0" value="Total Base" /></div>
                                            <div>
                                                <h:outputText 
                                                    style="font-size:1.5em"
                                                    value="#{contratoResumenBean.contrato.resumen.resumenTotal.totalBase}€" 
                                                />
                                            </div>
                                        </li>
                                        <li style="padding:4px">
                                            <div><h:outputLabel style="padding:0" value="Complementos" /></div>
                                            <div style="padding-left:1em">
                                                <h:outputText 
                                                    style="font-size:1.5em"
                                                    value="#{contratoResumenBean.contrato.resumen.resumenTotal.totalComplementos}€" 
                                                />
                                            </div>
                                        </li>                                        
                                        <li style="padding:4px">
                                            <div><h:outputLabel style="padding:0" value="Gastos Adicionales" /></div>
                                            <div style="padding-left:1em">
                                                <h:outputText 
                                                    style="font-size:1.5em"
                                                    value="#{contratoResumenBean.contrato.resumen.resumenTotal.totalGastosAdicionales}€" 
                                                />
                                            </div>
                                        </li>
                                        <li style="padding:4px">
                                            <div><h:outputLabel style="padding:0" value="Transportes" /></div>
                                            <div style="padding-left:1em">
                                                <h:outputText 
                                                    style="font-size:1.5em"
                                                    value="#{contratoResumenBean.contrato.resumen.resumenTotal.totalTransporte}€" 
                                                />
                                            </div>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div> 
                 
                    <table id="contenido-tabla" jsf:rendered="#{contratoResumenBean.contrato != null}" style="max-width: 800px">
                <tr>
                    <th id="primera-col-tabla" style="width: 85%" class="column-header fondo-oscuro">Producto</th>
                    <th id="ultima-col-tabla" style="width: 15%" class="column-header fondo-claro">Importe</th>
                </tr>
                <tr class="linea par" jsf:rendered="#{empty contratoResumenBean.contrato.lineas}">
                    <td class="celda-concepto ui-state-error" colspan="5">
                        <div class="content-concepto">
                            <div style="font-size:1.3em;font-weight:bold">No hay lineas.</div>
                        </div>
                    </td>
                </tr>
                <ui:repeat
                    rendered="#{not empty contratoResumenBean.contrato.lineas}"
                    value="#{contratoResumenBean.contrato.lineas}"
                    var="item"
                    varStatus="estado"
                >
                    <tr class="linea #{(estado.index % 2)==0 ? 'impar' : 'par'}">
                        <td class="celda-concepto">
                            <div class="content-concepto">
                                <div class="print-row">
                                    <div class="print-col" style="width: 80%">
                                        <div class="print-row" style="font-weight:bold;font-size: 1.25em">
                                            <div class="print-col" style="width:200px;">#{item.stock != null ? item.stock.numSerie : "SIN ASIGNAR"}</div>
                                            <div class="print-col">#{item.tipoOperacion.nombre}</div>
                                        </div>
                                        <div>#{item.concepto}</div>
                                        <div jsf:rendered="#{item.stock != null}" class="detalle">#{item.stock.tipoProducto.id}-#{item.stock.tipoProducto.descripcion}</div>
                                        <div jsf:rendered="#{item.stock == null}" class="detalle">#{item.tipoProducto.id}-#{item.tipoProducto.descripcion}</div>
                                    </div>
                                    <div jsf:rendered="#{item.tipoOperacion.id == 'AL'}" class="print-col" style="text-align:right;width: 20%">
                                        #{item.importe}€/#{contratoResumenBean.contrato.condiciones.facturarPor.nombre.toLowerCase()}
                                    </div>
                                    <div jsf:rendered="#{item.tipoOperacion.id != 'AL'}" class="print-col" style="text-align:right;width: 20%">
                                        #{item.importe}€
                                    </div>
                                </div>
                                
                                <h:panelGroup layout="block" rendered="#{!empty item.complementos}" style="padding-left:1em;padding-top:0.2em;font-size:0.9em">
                                    <strong>COMPLEMENTOS</strong>
                                    <div style="padding-left:1em">
                                        <table style="width:100%;border:0;font-size:0.9em" cellpadding="0" cellspacing="0">
                                            <ui:repeat value="#{item.complementos}" var="complemento">
                                                <tr class="iluminable">
                                                    <td style="text-align:left;width:60%">#{complemento.concepto}</td>
                                                    <td style="text-align:right;width:10%">x#{complemento.cantidad}</td>
                                                    <td style="text-align:right;width:15%" jsf:rendered="#{item.tipoOperacion.id == 'AL'}">
                                                        #{complemento.importe}€/#{contratoResumenBean.contrato.condiciones.facturarPor.nombre.toLowerCase()}
                                                    </td>
                                                    <td style="text-align:right;width:15%" jsf:rendered="#{item.tipoOperacion.id != 'AL'}">
                                                        #{complemento.importe}€
                                                    </td>
                                                    <td style="text-align:right;width:15%" jsf:rendered="#{item.tipoOperacion.id == 'AL'}">
                                                        #{complemento.importeTotal}€/#{contratoResumenBean.contrato.condiciones.facturarPor.nombre.toLowerCase()}
                                                    </td>
                                                    <td style="text-align:right;width:15%" jsf:rendered="#{item.tipoOperacion.id != 'AL'}">
                                                        #{complemento.importeTotal}€
                                                    </td>
                                                </tr>
                                            </ui:repeat>
                                        </table>
                                    </div>
                                </h:panelGroup>
                                <h:panelGroup layout="block" rendered="#{!empty item.gastosAdicionales}" style="padding-left:1em;padding-top:0.5em;font-size:0.9em">
                                    <strong>GASTOS ADICIONALES</strong>
                                    <div style="padding-left:1em">
                                        <table style="width:100%;border:0;font-size:0.9em" cellpadding="0" cellspacing="0">
                                            <ui:repeat value="#{item.gastosAdicionales}" var="gastosAdicional">
                                                <tr class="iluminable">
                                                    <td style="text-align:left;width:60%">#{gastosAdicional.concepto}</td>
                                                    <td style="text-align:right;width:10%">x#{gastosAdicional.cantidad}</td>
                                                    <td style="text-align:right;width:15%">#{gastosAdicional.importe}€</td>
                                                    <td style="text-align:right;width:15%">#{gastosAdicional.importeTotal}€</td>
                                                </tr>
                                            </ui:repeat>
                                        </table>
                                    </div>
                                </h:panelGroup>
                                <h:panelGroup layout="block" style="padding-left:1em;padding-top:0.5em;font-size:0.9em">
                                    <strong>TRANSPORTE ENTREGA</strong>
                                    <div style="padding-left:1em">
                                        <table style="width:100%;border:0;font-size:0.9em" cellpadding="0" cellspacing="0">
                                            <tr jsf:rendered="#{item.entregaTransporte != null}" class="iluminable">
                                                <td style="text-align:left;width:60%">#{item.entregaTransporte.empresa.nombre} - #{item.entregaTransporte.nombre}</td>
                                                <td style="text-align:right;width:40%">#{previsionMesesAlquiler == null ? '0.00' : previsionMesesAlquiler}€</td>
                                            </tr>
                                            <tr jsf:rendered="#{item.entregaTransporte == null}" class="iluminable">
                                                <td style="text-align:left;width:60%">Sus medios</td>
                                                <td style="text-align:right;width:40%">#{previsionMesesAlquiler == null ? '0.00' : previsionMesesAlquiler}€</td>
                                            </tr>
                                        </table>
                                    </div>
                                </h:panelGroup>
                                <h:panelGroup layout="block" style="padding-left:1em;padding-top:0.5em;font-size:0.9em">
                                    <strong>TRANSPORTE RECOGIDA</strong>
                                    <div style="padding-left:1em">
                                        <table style="width:100%;border:0;font-size:0.9em" cellpadding="0" cellspacing="0">
                                            <tr jsf:rendered="#{item.recogidaTransporte != null}" class="iluminable">
                                                <td style="text-align:left;width:60%">#{item.recogidaTransporte.empresa.nombre} - #{item.recogidaTransporte.nombre}</td>
                                                <td style="text-align:right;width:40%">#{item.recogidaImporte == null ? '0.00' : item.recogidaImporte}€</td>
                                            </tr>
                                            <tr jsf:rendered="#{item.recogidaTransporte == null}" class="iluminable">
                                                <td style="text-align:left;width:60%">Sus medios</td>
                                                <td style="text-align:right;width:40%">#{item.recogidaImporte == null ? '0.00' : item.recogidaImporte}€</td>
                                            </tr>
                                        </table>
                                    </div>
                                </h:panelGroup>
                            </div>
                        </td>
                        <td class="celda-total">
                            <div jsf:rendered="#{item.tipoOperacion.id == 'AL'}">
                                #{item.importeTotal}€/#{contratoResumenBean.contrato.condiciones.facturarPor.nombre.toLowerCase()}
                            </div>
                            <div jsf:rendered="#{item.tipoOperacion.id != 'AL'}">
                                #{item.importeTotal}€
                            </div>
                            <div jsf:rendered="#{item.gastosAdicionalesImporte > 0}">
                                +#{item.gastosAdicionalesImporte}€
                            </div>
                        </td>
                    </tr>
                </ui:repeat>
            </table>  
                </h:panelGroup>
            </h:form>
        </div>
    </ui:composition>
</html>